# Микросервис авторизации

## Предоставляемые услуги
* авторизация
* регистрация
* восстановление пароля

## Хранимые данные
* id
* email
* номер телефона
* хэш пароля
* имя
* фамилия

## Таблицы

|**id**|**email**|**telephone number**|**password hash**|
|-|-|-|-|
||||
||||
||||
||||

Хранение остальной информации о пользователе мы перекладываем на микросервис пользовательских профилей.

## Архитекутра
![alt text](https://github.com/MihailPoplavkov/authorization/blob/master/src/architecture.png)
Кэш не нужен, так как запросы в большинстве своем уникальны.
### Масштабирование
![alt text](https://github.com/MihailPoplavkov/authorization/blob/master/src/riak-ring.png)
### Репликация
![alt text](https://github.com/MihailPoplavkov/authorization/blob/master/src/riak-data-distribution.png)

## CAP
### Основные требования
#### C - consistency
* нельзя повторно регистрироваться с одним email-ом или телефоном
* на всех репликах должна храниться одна и та же информация по id
#### A - availability
* зарегистрированные пользователи могут зайти в систему в любой момент времени(чтение с любой реплики)
* запись/изменение данных либо во все реплики, либо ни в одну
#### P - partition tolerance
* расщепление распределённой системы на несколько изолированных секций не приводит к некорректности отклика от каждой из секций

Таким образом, в периоды высокой нагрузки на сервера, таймаутов жертвуем доступностью (availability).

## Методы API
### login request
|**Параметр**   |**Описание**        |
| --------------|--------------------|
| email or telephone number|email или телефон     |
| password    |пароль     |

#### answer
|**Параметр**   |**Описание**        |
| --------------|--------------------|
| flag       |true/false           |

### registration request
|**Параметр**   |**Описание**        |
| --------------|--------------------|
| name       | имя пользователя     |
| surname    |фамилия пользователя     |
| email  |электронная почта       |
| password       |пароль|
| telephone number    |номер телефона   |

#### answer
|**Параметр**   |**Описание**        |
| --------------|--------------------|
| flag       |true/false           |

### reset password request
|**Параметр**   |**Описание**        |
| --------------|--------------------|
| email/telephone number       | электронная почта или номер телефона    |

#### answer
|**Параметр**   |**Описание**        |
| --------------|--------------------|
| flag       |true/false           |
